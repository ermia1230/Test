import { vi, describe, it, expect } from "vitest";
import { getModule } from "./getModule";

const apiConfig = await getModule("/src/apiConfig")
import.meta.glob("/src/apiConfig.*s");

describe.skipIf(apiConfig.noApiConfig)("TW2.1.1 API config", function tw2_1_1() {
  it("apiConfig exports PROXY_URL and PROXY_KEY", function tw2_1_1_1() {
    const { PROXY_KEY, PROXY_URL }= apiConfig;
    expect(PROXY_URL).toBeDefined()
    expect(PROXY_KEY).toBeDefined()
    expect(typeof PROXY_URL).toBe("string")
    expect(typeof PROXY_KEY).toBe("string")
  })

  it("Check PROXY_URL is correct", function tw2_1_1_2() {
    const {  PROXY_URL }= apiConfig;
    const urlRegex = /^https:\/\/brfenergi\.se\/iprog\/group\/[0-9]/
    expect(PROXY_URL).toMatch(urlRegex)
  })

  it("Check length of PROXY_KEY", function tw2_1_1_3() {
    const { PROXY_KEY }= apiConfig;
    expect(PROXY_KEY).toHaveLength(50)
  })
})
