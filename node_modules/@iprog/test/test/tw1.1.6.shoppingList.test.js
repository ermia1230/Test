import {describe, it, expect} from "vitest";

import {shoppingList} from "/src/utilities";

const dishes = [
    {
	extendedIngredients: [
	    { aisle: "Produce", name: "pumpkin", id: 12, amount: 3.5 },
	    { aisle: "Frozen", name: "frozen broccoli", id: 14, amount: 10 },
	],
    },
    {
	extendedIngredients: [
	    { aisle: "Produce", name: "pumpkin", id: 12, amount: 10 },
	    { aisle: "Produce", name: "parsley", id: 13, amount: 21 },
	],
    },
    {
	extendedIngredients: [
	    { aisle: "Produce", name: "parsley", id: 13, amount: 42 },
	],
    },
];

describe("TW1.1.6 reduce(CB, acc) example: shoppingList", function tw1_1_6() {
    it("should add up ingredient amounts", function tw1_1_6_1() {
	const result = shoppingList(dishes);
	
	expect(result).toHaveLength(3);
	
	const pumpkin = result.filter(function is12CB(i){ return i.id === 12;});
	expect(pumpkin).toHaveLength(1);
	expect(pumpkin[0]?.amount).toBe(10+3.5);

	const parsley = result.filter(function is13CB(i){return  i.id === 13;});
	expect(parsley).toHaveLength(1);
	expect(parsley[0]?.amount).toBe(42+21);

	const broccoli = result.filter(function is14CB(i){ return i.id===14;});
	expect(broccoli).toHaveLength(1);
	expect(broccoli[0]?.amount).toBe(10);
    });
});
